## 1.谈谈你是如何理解 js 异步编程的，EventLoop、消息队列都是做什么的，什么是宏任务，什么是微任务？

### 1.1 如何理解 js 异步编程的

- js 语言的一大特点就是单线程，在某个特定的时刻只有特定的代码能够被执行，并阻塞其它的代码，也就是说，同一个时间只能做一件事。
- 怎么做到异步编程？回调函数。直到 nodejs 的出现，开始将回调模式的异步编程机制发挥的淋漓尽致，这种机制开始在前端变得非常流行，但是慢慢也体现出了回调函数在错误处理和嵌套上的副作用。
- 因为存在上面的不足，所以异步解决方案一直在发展中，从 callback => promise => generator + co 库 => async/await

### 1.2 EventLoop、消息队列都是做什么的

- 目的： 通过事件循环与消息队列实现 js 异步编程

1. 在 js 中， 所有同步任务都在主线程上执行，也可以理解为“执行栈”。
2. 主线程外，还有一个“消息队列”，消息队列的作用，就在等待异步任务的结果，只要异步任务有了运行结果，就会加入到“消息队列”中。
3. 一旦执行栈中所有同步任务执行完毕，就从 消息队列 中读取“任务”加入到“执行栈”中。
4. 主线程不断的循环上面的步骤。 就是 EventLoop

### 1.3 什么是宏任务，什么是微任务

1. 宏任务： 当前调用栈中执行的代码成为宏任务。（主代码快，定时器等等）
2. 微任务： 当前（此次事件循环中）宏任务执行完，在下一个宏任务开始之前需要执行的任务,可以理解为回调事件。（promise.then，proness.nextTick 等等）。
3. 宏任务执行过程中可以临时加上一些额外需求，对于这些额外需求，可以选择作为一个新的宏任务进到队列中排队 (setTimeout 就会再次去队列中排队)，也可以当作当前任务的 微任务 直接在当前任务结束后立即执行 (promise/MutationObserver/process.nextTick)
4. 宏任务中的事件放在 callback queue 中，由事件触发线程维护；微任务的事件放在微任务队列中，由 js 引擎线程维护。
